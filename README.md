# LiuShuli
LSLFruitsRecognition
# ğŸ LSLFruitsRecognition

åŸºäº **PyTorch** çš„æ°´æœå›¾åƒåˆ†ç±»é¡¹ç›®ï¼Œæ”¯æŒæ•°æ®é›†è‡ªåŠ¨åˆ’åˆ†ã€æ¨¡å‹è®­ç»ƒã€ONNX å¯¼å‡ºä»¥åŠ Visual Studio å·¥ç¨‹é›†æˆã€‚è¯¥é¡¹ç›®æ—¨åœ¨æ„å»ºä¸€ä¸ªé«˜æ€§èƒ½çš„æ°´æœè¯†åˆ«æ¨¡å‹ï¼Œå¯ç”¨äºæ™ºèƒ½åˆ†æ‹£ã€é›¶å”®è¯†åˆ«ç­‰è®¡ç®—æœºè§†è§‰åº”ç”¨ã€‚

---

## ğŸ“‚ é¡¹ç›®ç»“æ„

```
LSLFruitsRecognition/
â”œâ”€â”€ LSLFruitsRecognition.sln        # Visual Studio è§£å†³æ–¹æ¡ˆæ–‡ä»¶
â”œâ”€â”€ train.py                        # æ¨¡å‹è®­ç»ƒè„šæœ¬
â”œâ”€â”€ nn_spilt.py                     # æ•°æ®é›†åˆ’åˆ†è„šæœ¬
â”œâ”€â”€ nn_onnx.py                      # æ¨¡å‹å¯¼å‡ºä¸º ONNX æ ¼å¼
â”œâ”€â”€ fruits1_x.pth                   # è®­ç»ƒç”Ÿæˆçš„æ¨¡å‹æƒé‡æ–‡ä»¶
â””â”€â”€ Fruits1/                        # æ•°æ®é›†ç›®å½•ï¼ˆéœ€ç”¨æˆ·å‡†å¤‡ï¼‰
    â”œâ”€â”€ train/
    â”œâ”€â”€ val/
    â””â”€â”€ test/
```

---

## ğŸ§  åŠŸèƒ½è¯´æ˜

### 1ï¸âƒ£ æ•°æ®é›†åˆ’åˆ†ï¼ˆ`nn_spilt.py`ï¼‰

- æ”¯æŒå°†åŸå§‹æ•°æ®é›†æŒ‰ç±»åˆ«å¹³è¡¡åˆ’åˆ†ä¸º **è®­ç»ƒé›† / éªŒè¯é›† / æµ‹è¯•é›†**ã€‚
- è‡ªåŠ¨ç”Ÿæˆæ–‡ä»¶å¤¹ç»“æ„ï¼Œæ–¹ä¾¿åç»­åŠ è½½ã€‚
- å¯è‡ªå®šä¹‰æ¯”ä¾‹ä¸éšæœºç§å­ã€‚

**ä½¿ç”¨ç¤ºä¾‹ï¼š**
```bash
python nn_spilt.py --data_dir ./raw_dataset --output_dir ./Fruits1 --train_ratio 0.7 --val_ratio 0.15 --test_ratio 0.15
```

---

### 2ï¸âƒ£ æ¨¡å‹è®­ç»ƒï¼ˆ`train.py`ï¼‰

- æ”¯æŒå¤šç§æ•°æ®å¢å¼ºï¼ˆæ—‹è½¬ã€ç¿»è½¬ã€é€è§†ã€é¢œè‰²æ‰°åŠ¨ã€éšæœºæ“¦é™¤ç­‰ï¼‰ã€‚
- ä½¿ç”¨ **AdamW** ä¼˜åŒ–å™¨ä¸ **ä½™å¼¦é€€ç«å­¦ä¹ ç‡è°ƒåº¦å™¨**ã€‚
- é»˜è®¤åœ¨ GPU (CUDA) ä¸Šè®­ç»ƒï¼Œæ”¯æŒæ··åˆç²¾åº¦åŠ é€Ÿã€‚
- æ¯è½®è®­ç»ƒåè‡ªåŠ¨ä¿å­˜æ¨¡å‹æƒé‡åˆ° `fruits1_x.pth`ã€‚

**è®­ç»ƒç¤ºä¾‹ï¼š**
```bash
python train.py
```

**ä¸»è¦ç‰¹æ€§ï¼š**
- æ”¯æŒè‡ªå®šä¹‰ç±»åˆ«æ•°ã€‚
- å¯è½»æ¾æ›¿æ¢ä¸º `ResNet34`ã€`VGG16`ã€`EfficientNet` ç­‰ä¸»æµæ¶æ„ã€‚
- ä½¿ç”¨ `TensorBoard` è®°å½•è®­ç»ƒæ›²çº¿ï¼š
```bash
tensorboard --logdir=logs_train
```

---

### 3ï¸âƒ£ æ¨¡å‹å¯¼å‡ºï¼ˆ`nn_onnx.py`ï¼‰

- å°† `.pth` æ¨¡å‹å¯¼å‡ºä¸ºé€šç”¨çš„ **ONNX æ ¼å¼**ï¼Œä¾¿äºè·¨å¹³å°éƒ¨ç½²ï¼ˆå¦‚ C++ã€TensorRTã€OpenVINOï¼‰ã€‚
- æ”¯æŒåŠ¨æ€æ‰¹æ¬¡è¾“å…¥ã€‚

**ä½¿ç”¨ç¤ºä¾‹ï¼š**
```bash
python nn_onnx.py
```

ç”Ÿæˆæ–‡ä»¶ï¼š
```
fruits1_8.onnx
```

---

### 4ï¸âƒ£ Visual Studio é›†æˆï¼ˆ`LSLFruitsRecognition.sln`ï¼‰

è¯¥é¡¹ç›®å¯åœ¨ Visual Studio ä¸­æ‰“å¼€ï¼Œç”¨äºï¼š
- æ¨¡å‹æ¨ç†çš„ C++ ç«¯éƒ¨ç½²ã€‚
- è°ƒè¯•ä¸æ€§èƒ½æµ‹è¯•ã€‚
- ä¸ ONNX Runtime é›†æˆï¼Œå®ç°å¿«é€Ÿæ¨ç†ã€‚

---

## âš™ï¸ ç¯å¢ƒä¾èµ–

æ¨èç¯å¢ƒï¼š
- Python â‰¥ 3.8  
- PyTorch â‰¥ 2.0  
- TorchVision â‰¥ 0.15  
- scikit-learn â‰¥ 1.0  
- pandas â‰¥ 1.5  
- tensorboard  
- Pillow

**å®‰è£…ä¾èµ–ï¼š**
```bash
pip install torch torchvision scikit-learn pandas tensorboard Pillow
```

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

1. **å‡†å¤‡æ•°æ®é›†**
   ```
   dataset/
   â”œâ”€â”€ apple/
   â”‚   â”œâ”€â”€ 1.jpg
   â”‚   â”œâ”€â”€ 2.jpg
   â”œâ”€â”€ banana/
   â”‚   â”œâ”€â”€ 1.jpg
   â”‚   â”œâ”€â”€ 2.jpg
   ```
   > æ¯ä¸ªå­æ–‡ä»¶å¤¹ä¸ºä¸€ä¸ªç±»åˆ«ã€‚

2. **åˆ’åˆ†æ•°æ®é›†**
   ```bash
   python nn_spilt.py --data_dir ./dataset --output_dir ./Fruits1
   ```

3. **è®­ç»ƒæ¨¡å‹**
   ```bash
   python train.py
   ```

4. **å¯¼å‡º ONNX æ¨¡å‹**
   ```bash
   python nn_onnx.py
   ```

5. **éƒ¨ç½²æˆ–é›†æˆ**
   - åœ¨ C++ æˆ– Visual Studio ä¸­ä½¿ç”¨ `fruits1_8.onnx` è¿›è¡Œæ¨ç†ã€‚

---

## ğŸ“Š ç»“æœå¯è§†åŒ–

ä½¿ç”¨ TensorBoard ç›‘æ§è®­ç»ƒè¿‡ç¨‹ï¼š
```bash
tensorboard --logdir=logs_train
```
å¯æŸ¥çœ‹è®­ç»ƒ/éªŒè¯æŸå¤±ä¸å‡†ç¡®ç‡æ›²çº¿ã€‚

---

## ğŸ“œ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ **MIT License** å¼€æºåè®®ã€‚

---

## ğŸ§‘â€ğŸ’» ä½œè€…

**åˆ˜é¡ºåˆ© (Liu Shunli)**  
ğŸ“§ 2909026024@qq.com  
ğŸ“… åˆ›å»ºæ—¶é—´ï¼š2025å¹´  

---

â­ å¦‚æœè¯¥é¡¹ç›®å¯¹ä½ æœ‰å¸®åŠ©ï¼Œè¯·è®°å¾— Star æ”¯æŒä¸€ä¸‹ï¼
